CREATE TABLE artists (
    id INTEGER PRIMARY KEY,
    artist TEXT,
    collaboration_id INTEGER)
    ;

INSERT INTO artists VALUES
    (1, "BTS", 2),
    (2, "Blackpink", 1),
    (3, "Ariana Grande", 4),
    (4, "Justin Bieber", 3),
    (5, "Olivia Rodrigo", 8),
    (6, "Doja Cat", 7),
    (7, "SZA", 6),
    (8, "Bruno Mars", 5)
    ;
    
SELECT * FROM artists;

CREATE TABLE genre (
    id INTEGER PRIMARY KEY,
    genre TEXT)
    ;

INSERT INTO genre VALUES 
    (1, "kpop"),
    (2, "pop"),
    (3, "indie"),
    (4, "R&B")
    ;

SELECT * FROM genre;

CREATE TABLE hit_songs (
    id INTEGER PRIMARY KEY,
    artist_id INTEGER,
    hit_song TEXT)
    ;

INSERT INTO hit_songs VALUES
    (1, 2, "Kill This Love"),
    (2, 1, "Butter"),
    (3, 4, "STAY"),
    (4, 3, "7 Rings"),
    (5, 6, "drivers license"),
    (6, 5, "Kiss Me More"),
    (7, 8, "Good Days"),
    (8, 7, "Leave The Door Open")
    ;

SELECT * FROM hit_songs;

CREATE TABLE origin (
    id INTEGER PRIMARY KEY,
    country TEXT)
    ;

INSERT INTO origin VALUES 
    (1, "South Korea"),
    (2, "USA"),
    (3, "Canada")
    ;
    
CREATE TABLE artist_genre_origin
    (id INTEGER PRIMARY KEY,
    artist_id INTEGER,
    genre_id INTEGER,
    origin_id INTEGER)
    ;

INSERT INTO artist_genre_origin VALUES
    (1, 1, 1, 1),
    (2, 2,  1, 1),
    (3, 3,  2, 2),
    (4, 4,  2, 3),
    (5, 5,  3, 2),
    (6, 6,  4, 2),
    (7, 7,  4, 2),
    (8, 8, 4, 2)
    ;

SELECT * FROM artist_genre_origin;


SELECT * FROM origin;

/**JOINing related tables: come up with a query that shows the artist name next to their hit song **/

SELECT a.artist, hs.hit_song FROM artists AS a
    JOIN hit_songs AS hs
    ON a.id = hs.artist_id;

/**Combining multiple JOINs: come up with a query that shows the artist name next to their genre and origin id **/

SELECT a.artist, g.genre, o.country FROM artist_genre_origin AS ago
    JOIN artists AS a
    ON ago.artist_id = a.id
    JOIN genre AS g
    ON ago.genre_id = g.id
    JOIN origin As o
    ON ago.origin_id = o.id
    ;

/**JOINing tables to themselves with self-joins: come up with a query that shows the artist name next to the name of the artist they are assigned to collaborate music with **/

SELECT artists.artist AS artist_name, collab.artist AS collab_partner FROM artists
    JOIN artists collab
    ON artists.collaboration_id = collab.id
    ;






